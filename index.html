<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>rpibotly</title>
  <script src="blockly/blockly_compressed.js"></script>
  <script src="blockly/blocks_compressed.js"></script>
  <script src="blockly/msg/js/en.js"></script>
  <script src="blockly/python_compressed.js"></script>
  <script src="blocks_raspibot.js"></script>
  <script src="python_raspibot.js"></script>
  <link href="blockly.css" rel="stylesheet">
</head>
<body>

<div class="app-container">
  <div id="blocklyDiv" class="main blockly-panel"></div>
  <div id="codeDiv" class="main output-panel">
    <pre class="prettyprint"></pre>
  </div>
  <div id="playButton" class="play-button">&#9654;</div>
</div>

<xml id="toolbox" style="display: none">
  <category id="catRobot" colour="15" name="Robot">
    <block type="led1">
      <value name="STATE">
        <shadow type="on_off">
          <field name="STATE">0</field>
        </shadow>
      </value>
    </block>
    <block type="led2">
      <value name="STATE">
        <shadow type="on_off">
          <field name="STATE">0</field>
        </shadow>
      </value>
    </block>
  </category>
  <category id="catInOut" colour="270" name="In/Out">
    <block type="on_off"></block>
  </category>
  <category id="catTime" colour="60" name="Time">
    <block type="wait">
      <value name="TIME_S">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
    </block>
  </category>
  <sep></sep>
  <category id="catLoops" colour="120" name="Loops">
    <block type="controls_repeat_ext">
      <value name="TIMES">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
    <block type="controls_for">
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
      <value name="BY">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
    </block>
  </category>
  <category id="catLogic" colour="210" name="Logic">
    <block type="controls_if"></block>
    <block type="logic_compare"></block>
    <block type="logic_operation"></block>
  </category>
  <category id="catMath" colour="230" name="Math">
    <block type="math_number"></block>
    <block type="math_arithmetic">
      <value name="A">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="B">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
    </block>
    <block type="math_number_property">
      <value name="NUMBER_TO_CHECK">
        <shadow type="math_number">
          <field name="NUM">0</field>
        </shadow>
      </value>
    </block>
    <block type="math_random_int">
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
    </block>
    <block type="math_modulo">
      <value name="DIVIDEND">
        <shadow type="math_number">
          <field name="NUM">64</field>
        </shadow>
      </value>
      <value name="DIVISOR">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
  </category>
  <category id="catVariables" colour="330" custom="VARIABLE" name="Variables"></category>
</xml>

<script>
  var workspace = Blockly.inject('blocklyDiv', {
    toolbox: document.getElementById('toolbox'),
    media: 'blockly/media/'
  });
  function myUpdateFunction(event) {
    var codeDiv = document.getElementById('codeDiv');
    var codeHolder = document.createElement('pre');
    var code = document.createTextNode(Blockly['Python'].workspaceToCode(workspace));
    codeHolder.appendChild(code);
    codeDiv.replaceChild(codeHolder, codeDiv.lastElementChild);
  }
  workspace.addChangeListener(myUpdateFunction);
</script>

</body>
</html>
